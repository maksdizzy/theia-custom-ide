"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const c=require("@theia/core/lib/node/messaging/websocket-endpoint"),a=require("@theia/core/shared/inversify"),u=require("socket.io");var d=Object.getOwnPropertyDescriptor,l=(i,n,o,e)=>{for(var t=e>1?void 0:e?d(n,o):n,r=i.length-1,s;r>=0;r--)(s=i[r])&&(t=s(t)||t);return t};exports.WebsocketEndpoint=class extends c.WebsocketEndpoint{onStart(n){new u.Server(n,{pingInterval:this.checkAliveTimeout,pingTimeout:this.checkAliveTimeout*2,maxHttpBufferSize:this.maxHttpBufferSize,cors:{origin:"*",methods:["GET","POST"],credentials:!0}}).of(/.*/).on("connection",async e=>{const t=e.request;t.headers.origin=t.headers["fix-origin"],await this.allowConnect(e.request)?(await this.handleConnection(e),this.messagingListener.onDidWebSocketUpgrade(e.request,e)):e.disconnect(!0)})}};exports.WebsocketEndpoint=l([a.injectable()],exports.WebsocketEndpoint);
//# sourceMappingURL=websocket-endpoint.js.map
